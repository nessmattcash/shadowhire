  <app-header></app-header>

<div class="jobs-portal">
  <app-header></app-header>
  <!-- Hero Section with Company Showcase -->
  <section class="hero-section dark-blue-bg">
    <div class="container">
      <div class="hero-content">
        <h1 class="hero-title">Find Your Dream <span class="highlight">Job</span></h1>
        <p class="hero-subtitle">Discover opportunities from top companies</p>
        
        <!-- Search Bar -->
        <div class="search-container" data-aos="fade-up" data-aos-delay="200">
          <div class="search-box">
            <i class="bi bi-search"></i>
            <input type="text" id="jobSearch" placeholder="Search by job title, skills or company..." 
                   (input)="onSearchChange($event)">
            <button class="search-btn" (click)="triggerSearch()">Search</button>
          </div>
        </div>
      </div>
      
      <!-- Company Logo Showcase -->
      <div class="company-showcase" data-aos="fade-up" data-aos-delay="400">
        <div class="swiper-container" #companySwiper>
          <div class="swiper-wrapper">
            <div class="swiper-slide" data-background="/assets/EY.jpg"></div>
            <div class="swiper-slide" data-background="/assets/micro.jpg"></div>
            <div class="swiper-slide" data-background="/assets/OpenAI.jpg"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Filters Section -->
  <section class="filters-section" data-aos="fade-up">
    <div class="container">
      <div class="filters-header">
        <h2>Refine Your Search</h2>
        <button class="btn-clear" (click)="clearFilters()">Clear All</button>
      </div>
      
      <div class="filters-grid">
        <div class="filter-group">
          <label for="skillsFilter">Skills</label>
          <input type="text" id="skillsFilter" placeholder="e.g. JavaScript, Python, React" 
                 [(ngModel)]="skillsFilter" (input)="applyFilters()">
        </div>
        
        <div class="filter-group">
          <label for="locationFilter">Location</label>
          <input type="text" id="locationFilter" placeholder="e.g. Paris, Remote, New York" 
                 [(ngModel)]="locationFilter" (input)="applyFilters()">
        </div>
        
        <div class="filter-group">
          <label for="companyFilter">Company</label>
          <input type="text" id="companyFilter" placeholder="e.g. Microsoft, Google" 
                 [(ngModel)]="companyFilter" (input)="applyFilters()">
        </div>
      </div>
    </div>
  </section>

  <!-- Jobs Listing Section -->
  <section class="jobs-section">
    <div class="container">
      <!-- Loading Spinner with Progress -->
      <div *ngIf="isLoading" class="loading-container" data-aos="fade-in">
        <div class="spinner"></div>
        <p>Loading opportunities...</p>
        <div class="progress-bar" [style.width]="progress + '%'"></div>
      </div>

      <!-- Error Message -->
      <div *ngIf="error" class="error-container" data-aos="fade-in">
        <i class="bi bi-exclamation-triangle"></i>
        <p>{{ error }}</p>
        <button class="btn-retry" (click)="fetchJobs()">Try Again</button>
      </div>

      <!-- Results Count and Navigation -->
      <div *ngIf="!isLoading && !error" class="results-header" data-aos="fade-up">
        <h3>Found <span class="count">{{ filteredJobs.length }}</span> job opportunities</h3>
        <div class="job-navigation">
          <button *ngFor="let page of getPageNumbers()" 
                  [class.active]="currentPage === page" 
                  (click)="goToPage(page)">{{ page }}</button>
        </div>
      </div>

      <!-- Jobs Grid -->
      <div *ngIf="!isLoading && !error" class="jobs-grid">
        <div *ngFor="let job of paginatedJobs; let i = index" class="job-card" 
             data-aos="fade-up" [attr.data-aos-delay]="i * 50" (click)="openJobPopup(job)" [class.selected]="isJobSelected(job)">
          <div class="card-header">
            <div class="company-info">
              <div class="company-logo">
                <img [src]="getCompanyLogo(job.company)" [alt]="job.company">
              </div>
              <div class="company-details">
                <h3 class="job-title">{{ job.title }}</h3>
                <p class="company-name">{{ job.company }}</p>
                <span class="featured-tag" *ngIf="job.isFeaturedShown">Featured</span>
              </div>
            </div>
          </div>
          
          <div class="card-body">
            <div class="job-meta">
              <div class="meta-item">
                <i class="bi bi-geo-alt"></i>
                <span>{{ job.location }}</span>
              </div>
              <div class="meta-item">
                <i class="bi bi-clock"></i>
                <span>{{ formatDate(job.created_at) }}</span>
              </div>
            </div>
            
            <div class="skills-container">
              <div class="skills-label">Skills Required:</div>
              <div class="skills-list">
                <span *ngFor="let skill of getSkillsArray(job.skills_required)" class="skill-tag" 
                      title="Click to filter by {{ skill }}">{{ skill }}</span>
              </div>
            </div>
            
            <div class="job-description-teaser">{{ getTwoLineDescription(job.description) }}</div>
          </div>
          
          <div class="card-footer">
            <button class="btn-view-details" (click)="navigateToJob(job.id); $event.stopPropagation()">View Details</button>
            <button class="btn-save" (click)="toggleSaveJob(job); $event.stopPropagation()">
              <i class="bi" [class.bi-bookmark]="!isJobSaved(job)" [class.bi-bookmark-fill]="isJobSaved(job)"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- No Results Message -->
      <div *ngIf="!isLoading && !error && filteredJobs.length === 0" class="no-results" data-aos="fade-in">
        <i class="bi bi-search"></i>
        <h4>No jobs found</h4>
        <p>Try adjusting your search criteria or filters</p>
      </div>

      <!-- Job Popup -->
      <div class="job-popup" *ngIf="selectedJob" (click)="closeJobPopup($event)">
        <div class="popup-content" (click)="stopPropagation($event)">
          <button class="close-btn" (click)="closeJobPopup($event)">Ã—</button>
          <div class="popup-header">
            <div class="company-logo">
              <img [src]="getCompanyLogo(selectedJob.company)" [alt]="selectedJob.company">
            </div>
            <div class="company-details">
              <h3 class="job-title">{{ selectedJob.title }}</h3>
              <p class="company-name">{{ selectedJob.company }}</p>
              <span class="featured-tag" *ngIf="selectedJob.isFeaturedShown">Featured</span>
            </div>
          </div>
          <div class="popup-body">
            <div class="job-meta">
              <div class="meta-item">
                <i class="bi bi-geo-alt"></i>
                <span>{{ selectedJob.location }}</span>
              </div>
              <div class="meta-item">
                <i class="bi bi-clock"></i>
                <span>{{ formatDate(selectedJob.created_at) }}</span>
              </div>
            </div>
            <div class="skills-container">
              <div class="skills-label">Skills Required:</div>
              <div class="skills-list">
                <span *ngFor="let skill of getSkillsArray(selectedJob.skills_required)" class="skill-tag">
                  {{ skill }}
                </span>
              </div>
            </div>
            <div class="job-description-full" [style.height]="getDescriptionHeight(selectedJob.description)">
              {{ selectedJob.description || 'Embark on an exciting journey with this role! Dive into a dynamic environment where your skills will shine, offering opportunities to grow, innovate, and collaborate with top-tier professionals. Expect a competitive salary, flexible hours, and a chance to leave your mark on groundbreaking projects.' }}
            </div>
          </div>
          <div class="popup-footer">
            <button class="btn-view-details" (click)="navigateToJob(selectedJob.id); closeJobPopup($event)">View Details</button>
            <button class="btn-save" (click)="toggleSaveJob(selectedJob); $event.stopPropagation()">
              <i class="bi" [class.bi-bookmark]="!isJobSaved(selectedJob)" [class.bi-bookmark-fill]="isJobSaved(selectedJob)"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
<app-footer></app-footer>